--@shared
--@name TTS

if SERVER then
    hook.add( 'PlayerSay', 'tts', function( ply, text, teamChat )
        if ply == owner() then
            net.start('tts')
            net.writeString(text)
            net.send()
            --return ""
        end
    end)
elseif CLIENT then
    local snd
    function speech( text )
        if not text then return end
        text = http.urlEncode(text)
        local url = "http://translate.google.com/translate_tts?ie=utf-8&client=tw-ob&tl=".."pl-PL".."&q="..text
        if isValid( curr ) then curr:stop() end
        bass.loadURL( url, '3d noblock', function( snd, err, name )
            if not isValid( snd ) then return end
            curr = snd
            snd:setVolume(1.5)
            snd:setPos(owner():getPos())
            snd:setPitch(1)

        end)
    end
    net.receive( 'tts', function()
        text = net.readString()
            speech(text)
    end)
end